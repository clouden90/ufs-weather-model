mkdir INPUT DATM_INPUT RESTART history MOM6_OUTPUT

export DATM=true
if [ $GEFS_FORCING = .T. ]; then
 export DATM_SRC="GEFS"
 export FILENAME_BASE='gefs.'
else
 export DATM_SRC="CFSR"
 export FILENAME_BASE='cfsr.'
fi

# FV3 fixed input
cp    @[RTPWD]/DATM/@[FILENAME_BASE]SCRIP.nc DATM_INPUT
ln -s  @[RTPWD]/DATM/@[DATM_SRC]/201110/* DATM_INPUT

# MOM6 fixed input
cp    @[RTPWD]/MOM6_FIX/@[OCNRES]/* ./INPUT
cp    @[RTPWD]/MOM6_FIX_DATM/@[OCNRES]/* ./INPUT

# CICE fixed input
cp    @[RTPWD]/CICE_FIX/@[OCNRES]/grid_cice_NEMS_mx@[OCNRES].nc .
cp    @[RTPWD]/CICE_FIX/@[OCNRES]/kmtu_cice_NEMS_mx@[OCNRES].nc .
cp    @[RTPWD]/CICE_FIX/@[OCNRES]/mesh.mx@[OCNRES].nc .

if [ $WARM_START = .F. ]; then
# cold start
 if [[ $OCNRES == '025' ]]; then
  cp    @[RTPWD]/MOM6_IC/@[OCNRES]/2011100100/MOM*.nc ./INPUT
  cp    @[RTPWD]/CICE_IC/@[OCNRES]/cice_model_@[ICERES].cpc*.nc cice_model.res.nc
 else
  cp    @[RTPWD]/MOM6_IC/@[OCNRES]/2011100100/MOM6_IC_TS*.nc ./INPUT/MOM6_IC_TS.nc
  cp    @[RTPWD]/CICE_IC/@[OCNRES]/cice_model_@[ICERES].cpc*.nc cice_model.res.nc
 fi
else
# warm start
 cp ../${DEP_RUN}${RT_SUFFIX}/RESTART/MOM*.nc ./INPUT

# CMEPS restart and pointer files
 RFILE="DATM_${DATM_SRC}.cpl.r.2011-10-01-21600.nc"
 cp ../${DEP_RUN}${RT_SUFFIX}/RESTART/${RFILE} .
 ls -1 ${RFILE}>rpointer.cpl

# CICE restart and pointer files
 cp ../${DEP_RUN}${RT_SUFFIX}/RESTART/iced.2011-10-01-21600.nc ./INPUT
 RFILE="iced.2011-10-01-21600.nc"
 ls -1 "./INPUT/"${RFILE}>ice.restart_file
fi
